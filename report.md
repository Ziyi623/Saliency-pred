# 实验报告

2025机器学习基础课程大作业 题目三 图像显著性实验报告

## 一、任务描述

​	每个数据集中，待检测图像为人眼直接观察的彩色图像，保存在**Stimuli**文件夹；对应的显著图(即ground truth)为相同尺寸的灰度图像，颜色越亮的区域代表显著性越强，保存在**FIXATIONMAPS**文件夹。考虑到图像内容可能对结果产生影响，每个数据集都包括20种不同类型的图像，存放在20个文件夹中（如**Action**，**Affective**，**Art**……），因此分析结果时，既可以给出总体性能，又可以按类型进行分析。



## 二、实验模型原理和概述

### 图像显著性

​	视觉显著性是指对于真实世界中的场景，人们会自动的识别出感兴趣区域，并对感兴趣的区域进行处理，忽略掉不感兴趣的区域。图像的注意预测，也称视觉显著性检测。指通过智能算法模拟人的视觉系统特点，预测人类的视觉凝视点和眼动，提取图像中的显著区域(即人类感兴趣的区域)，是计算机视觉领域关键的图像分析技术。

### GAN神经网络	

​	本次实验采用 GAN 架构预测图像显著图。

​	**生成对抗网络**（Generative Adversarial Network，简称**GAN**）是非监督式学习的一种方法，通过两个神经网络相互博弈的方式进行学习。该方法由 lan Goodfellow 等人于2014年提出。生成对抗网络由一个生成网络与一个判别网络组成。生成网络从潜在空间（latent space）中随机取样作为输入，其输出结果需要尽量模仿训练集中的真实样本。判别网络的输入则为真实样本或生成网络的输出，其目的是将生成网络的输出从真实样本中尽可能分辨出来。而生成网络则要尽可能地欺骗判别网络。两个网络相互对抗、不断调整参数，最终目的是使判别网络无法判断生成网络的输出结果是否真实。

![](data\imgs\GAN_generator.jpeg)

## 三、实验模型结构与参数

实验采用UNet作为generator,采用 PatchGAN 条件判别器作为discriminator

### UNet网络结构

![](data\imgs\UNetGenerator.png)

​	U-Net 是一种用于生物医学图像分割的卷积神经网络架构。它通过引入一种新颖的网络结构和训练策略解决了传统方法在数据量不足时面临的挑战。U-Net 的主要思想是利用数据增强技术来高效利用有限的标注样本，并通过独特的网络设计来提高分割精度。

​	U-Net 的核心结构包括：

​	**1.编码器**：一系列卷积池化层，用于捕获图像的上下文信息。

​	**2.解码器**：一系列上采样层和卷积层，用于恢复分割的精细细节。

​	**3.跳跃连接**：从收缩路径复制特征图到相应的扩展路径，以保留更多的细节信息。

### PatchGAN网络结构

![img_patchGAN](data\imgs\PatchGAN_structure.png)

​	discriminator的设计是仅输出一个评价值（True or False），该值是对生成器生成的**整幅图像**的一个评价。而PatchGAN的设计不同，PatchGAN设计成全卷积的形式，图像经过各种卷积层后，并不会输入到全连接层或者激活函数中，而是使用卷积将输入映射为**N\*N矩阵**，该矩阵等同于原始GAN中的最后的评价值用以评价生成器的生成图像。	

## 四、实验结果分析

### 训练过程loss曲线收敛

Generator 的 loss 由$L_{adv}$和$L_{l1}$两部分加权构成，其中$L_{adv}$评判局部结构分布的真实性，防止图像模糊化；$L_{l1}$评判图像整体亮暗的正确性，是显著性检测的主损失；$\lambda_{adv}$和$\lambda_{l1}$都是常参数：
$$
L_G = \lambda_{adv}L_{adv}+\lambda_{l1}L_{l1}
$$
下图分别为$L_{G}$,$L_{adv}$和$L_{l1}$的收敛曲线：

![](data\imgs\lossG_plot.png)

![](data\imgs\Adv_plot.png)

![](data\imgs\L1_plot.png)

三曲线的收敛下降趋势基本一致，$L_{adv}$的波动较$L_{l1}$更大。

### 相关性分析与KL散度分析

使用训练的GAN网络预测测试集并进行相关性与kl散度分析，得到数据如下。

<img src="data\imgs\cc_distribution.png" style="zoom:25%;" />

测试集400张预测图的相关性中位数为0.757，均值为0.731，存在个别预测结果很差的个例。以103号图片（经data loader打乱后的编号）为例，该图原图为

![](data\imgs\00103_color.png)

分析得到的显著图为

![](data\imgs\00103.png)

我在TestSet中寻找该对应图片未果后意识到，在常规预处理数据集时，正态化和分辨率调整操作对部分数据造成了严重的影响。这导致了一部分数据结果明显差于其他数据，这一现象在偏暗偏灰的图像中居多。而对于LineDrawing, Sketch等整体偏白、以线条为主体的数据集，由于其显著图Ground Truth本身较为简单、模糊，预测显著图的相关性也普遍较好。

下图为KL散度分布图

<img src="data\imgs\kl_distribution_log.png" style="zoom:25%;" />

KL散度指标明显表现出了中心居多的分布，这在统计上与相关性得分是显著不同的。

KL 散度的精确含义是： 在遵循真实分布 P 的情况下，因使用近似模型 Q 进行描述而导致的平均额外信息量，或期望的信息损失。

从期望的信息损失而言，表现出中间高两头低的分布是合理的。而相关性分析由于其本身的数学特性，靠近1的一端逼近难度陡然上升，故难以出现相同的统计分布。而相关性中值的位置代表该模型有较为良好的显著图预测能力，这是难以从KL图中发现的。

<img src="data\imgs\cc_vs_kl_hexbin.png" style="zoom:25%;" />

上图为相关性系数和KL散度的联合分析，对于大部分数据而言相关性和KL散度得到的评价结果相近，仅有极少部分数据出现了相关性与KL散度评价分离的情况。出现严重分离的少数个例集中在相关性0.6前后，根据图像与其显著图并未发现明显关联规律。

## 五、总结

1920 $\times$ 1080 的分辨率在压缩为便于网络处理的过程中难免有所损失，原数据集图像虽都有相同的分辨率，部分图像实际上仅占有1920 $\times$ 1080的一小部分，这进一步加剧了分辨率压缩过程的损失。正态化不同通道的调整同样对图像颜色分布有一定的影响，如果图像的分类相近理论上而言应该会有更好的训练效果。

图像显著性预测问题相对更为复杂，人肉眼观察的结果校正能力有限，更依赖于参考他人工作结果作为baseline来校正评价实验结果。

整体而言，本次实验的网络预测结果较为良好，对图像显著性的预测基本符合常识判断。



